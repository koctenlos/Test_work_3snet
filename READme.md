# Описание автотестов
## 1. Блок с кодом для вставки

1. проверяется, что в поле с кодом присутствует iframe
2. проверяется наличие обязательных атрибутов iframe
3. проверяется, что поле с кодом недоступно для редактирования
----------------------------------
## 2. Кнопка «Скопировать код»

После нажатия текст кнопки меняется на "Скопировано", через несколько секунд текст возвращается обратно. Кнопка ищется по id, так как после клика текст кнопки временно меняется, и поиск по имени становится нестабильным. 

Отмечу, что при использовании кода:
  
 > const copybutton=page.getByRole('button', {name:'Скопировать код'});
 > await expect(copybutton).toBeVisible();
 > await copybutton.click();
 > await expect (copybutton).toContainText('Скопировано') 
-
тест заваливался, так как происходило слишком долгое ожидание, в ходе которого кнопка изменяла текст с "Скопировано" обратно на "Скопировать код".

Позже выяснилось, что искать надо не по "name:'Скопировать код'", а через locator('#code-copy-button'), так как после нажатия на кнопку имя изменялось.
------------------------------------------
## 3. Изменение цвета виджета

при выборе цветовой схемы обновляется код iframe, в коде появляется выбранный цвет
-----------------------------------------------
## 4. Создание календаря и превью

пользователь выбирает параметры календаря, нажимает кнопку "Сгенерировать превью", на странице появляется iframe с превью календаря, данные внутри iframe загружаются асинхронно, поэтому используется увеличенный таймаут ожидания
------------------------------------------
# Общие особенности-
1. Страница конструктора использует одинаковый `id="3snet-frame"` как в блоке с кодом для вставки, так и в iframe превью.
2. Такое поведение обусловлено тем, что пользователю предлагается готовый код, который затем используется для отображения превью непосредственно на странице.
3. В тестах iframe превью определяется по атрибуту `src` (`iframe[src*="widget-active-events"]`), так как использование `id` не позволяет однозначно отличить iframe с превью от iframe в коде для вставки.
--------------------------------------------------------------
# Запуск тестов-
1. npm install
2. npx playwright test